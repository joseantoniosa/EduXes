\chapter{Description}


Below a detailed list of procedures to build \emph{EduXes} application, will be described.
\section{Preparation of development}
Firstly Java Development Kit (JDK) version 1.6 is needed, to build application itself and the Eclipse IDE, is downloaded from \emph{Oracle}: 
\cite{JavaSE}
\begin{quote}
\url{http://www.oracle.com/technetwork/java/javase/downloads/index.html}
\end{quote}

As root user that file is unpacked into {\bf /usr/lib/jvm } and configured to be the Java default:
%%  \begin{bclogo}[couleur=green!30,arrondi=0.1, logo=\bcpanchant,  ombre=true ] 
\begin{bclogo}[couleur=red!30,arrondi=0.1, logo=\bcpanchant,  ombre=true ] 
{Update Java}   
\begin{verbatim}
 # update-java-alternatives -s JDK_1.6_NAME
\end{verbatim}
\end{bclogo}

	\emph{Eclipse Juno (4.6)} is downloaded from its site \cite{Eclipse}: $Download \rightarrow Linux \, 64\, bits$
\begin{quote}
\url{http://www.eclipse.org}
\end{quote}
Android Development Toolkit (ADT)\cite{AndroidDevelopmentKit} is downloaded following instructions on this page:
\begin{quote}
\url{http://developer.android.com/sdk/installing/installing-adt.html}
\end{quote}

	In Eclipse a new line is included into repository software ($Help \rightarrow  Install\, New\, Software \rightarrow Add$):
\begin{quote}
\url{http://dl-ssl.google.com/android/eclipse/}
\end{quote}
	Next step is to select all the related software listed.
	
	For Aptana Plugin the line to be added into Eclipse is: 
\begin{quote}
\url{http://download.aptana.com/studio3/plugin/install}    
\end{quote}


	Furthermore JQuery, JQueryMobile and Phonegap are needed, and were downloaded from their web sites:
	\begin{itemize}
	    \item {JQuery 1.8.1} (no newer versions), from \url{http://jquery.com/} :
	    \subitem JQuery will be  copied into {\bf assets/www/js} folder.
	    \item {JQueryMobile 1.1.1} from \url{ http://jquerymobile.com/}: 
        \subitem JQueryMobile is a zip file which will be uncompressed and copied into  {\bf assets/www/js} folder.
        \item{PhoneGap - Cordova 1.8.1} is downloaded from \url{https://github.com/phonegap/phonegap/zipball/1.8.1}
        and installed following reference \cite{PhoneGapGS} 

	\end{itemize}

	To create a PhoneGap application there are very important instructions (Getting Started with Android)  should be followed step by step:
\cite{AndroidGettingStarted}
\section{Application Skeleton}
  Next step is to choose application name and folders policy. Name \emph{EduXes} stands for "Educaci\'n" and "Xesti\'on", is a educational management software.
About folders policy, a folder is created ({\bf assets/www/js}) which contains javascript ({\bf *.js}) files except \emph{JQuery} and \emph{JQueryMobile} which is included into another
 folder ({ \bf assets/www/js/jquery} ), do not forget style sheets files ({\bf *.css } )
 
To finish building application skeleton a simple application is created which contains only a blank page.
 
Getting started with Android \cite{AndroidGettingStarted} is followed step by step.

\section{Upload into Git repository}

 Following stage is to upload that simple application into a git repository. 
An account is created in Github\cite{GitHub}, which is the largest code host in the world,  and a new application is initialized.  This are the source code project page \url{https://github.com/joseantoniosa/EduXes}.

Then source code are upload to Github: 

  \begin{bclogo}[couleur=green!30,arrondi=0.1, logo=\bcpanchant,  ombre=true ] 
{Git init shell}   
\begin{verbatim}
$ git init
$ git add -A *
$ git remote add  EduXes git@github.com:joseantoniosa/EduXes.git 
$ git push origin master
\end{verbatim}
\end{bclogo}

Each time an update in code is done,  code is uploaded :

  \begin{bclogo}[couleur=green!30,arrondi=0.1, logo=\bcpanchant,  ombre=true ] 
{Git update}   
\begin{verbatim}
$ git add -A *
$ git commit -m 'CHANGES_DESCRIPTION'
$ git push origin master
\end{verbatim}
\end{bclogo}


\section{Development}
 Before begining with development itself is compulsory to explain some concepts already shown above in Methodology (\ref{Methodology}), but with more detail:
JQueryMobile \cite{JQueryMobile} and by extension,  PhoneGap \cite{PhoneGap}  applications, are structured in pages:
 \begin{quote}
  <div data-role="page">
 \end{quote}

   which are very similar to desktop applications windows. Therefore, from Javascript code, to change to a new page 
  
     \$.mobile.changePage("\#daily\_work")  opens daily\_work page.  
     
% Application Work-flow 
% Next illustration try to be self-explicative.  Beginning at onDeviceReady()  from interface.fs file.  Inside each page several actions are performed: e.g., open and populate database, load list of groups (loadSchedule()),  and user choose next step according options shown. 
% 
% 
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 
% 
% Development:
As shown before (\ref{Methodology}) \emph{EduXes} contains several files:
\begin{itemize}
\item Four files contain application code itself:
\subitem  {\bf interface.js} : It contains information and decisions related to interface and application workflow, completely independent from database. It is located in {\bf assets/www/js} folder.
\subitem { \bf database.js} : It contains database related code: SELECT, INSERT, etc. It is located in {\bf assets/www/js} folder.
\subitem {\bf index.html}, {\bf remove.html} only contain HTML framework, page properties, and static content.  They are located in {\bf assets/www/} folder.
\item There are three important files which contain documentation:
\subitem {\bf TODO.txt}. List of goals to be achieved and milestone reached. It is located in root application folder.
\subitem {\bf DATABASE.sql}.  Data-base structure in SQL format. This file are shown below. It is located in root application folder.
\subitem {\bf REAME.txt}. Only contains general information about this application.It is located in root application folder.
\end{itemize}

Also, \emph{Eclipse} generates several files, the most important is the application file, which is an {\bf apk } package: {\bf bin/EduXes.apk}.

Next step is to build database, this will be described below \ref{DataBase}. 
Following database, sample data is needed to begin application development . 
\subsection{Groups}

The first window to be developed is \emph{List of Groups}: as shown above \ref{Methodology}, firstly a \emph{page} is created inside {\bf index.html}. This page has a three important elements:
\begin{itemize}
    \item  \emph{header}. It could contain a backward button, which return application flow to previous visited page. This is disabled,
because it could cause problems when previous page is an edit page, and another solution is preferred.    
    \item \emph{content}. Data itself, it has an important \emph{id} to be filled with content by javascript code.
    \item \emph{footer}. Usually page name.
\end{itemize}
\begin{bclogo}[couleur=blue!30,arrondi=0.1,ombre=true ] 
%% \begin{bclogo}[couleur=blue!30,arrondi=0.1, logo=\bcpanchant, barre=zigzag,  ombre=true ] 
{List Groups page. index.html}
\begin{verbatim}
<div data-role="page" id="list_groups" data-add-back-btn="true">
    <div data-role="header"  data-add-back-btn="false"  >
        <a href="#list_settings"  data-icon="arrow-l"
             data-theme="a" data-role="button">Back</a>
        <h1>Groups List</h1>
    </div>                
    
    <div data-role="content">
    <ul id="groups_ul" data-role="listview" data-inset="true"  
        data-split-icon="gear" data-split-theme="a" >
    </ul>
     <hr />
     <a  style="text-align: center" onClick="onAddNewGroup();" 
        data-role="button" data-icon="add">Add New Group</a>
    </div>
    <div data-role="footer"  data-rel="back" data-theme="a">
     <p style="text-align: center">List of Groups</p>
    </div>
</div>
\end{verbatim}
\end{bclogo}

Second window to be developed is edit group information.



\subsection{Students}    

\subsection{Attendance}  
Main page.
Repor Attendance.
\subsection{Activities}    
\subsection{Assessment}    
  

%  i) Timetable for actual date: list of groups for selected day.
% Below queryScheduleSuccess() and querySchedulePerDayDB() functions are written, these functions fills daily_schedule page as shown in Illustration 6: Application Skeleton.
% 
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 
% 
% 
% 
% 
% 
% /*
%  *  Main Window
%  */
% function queryScheduleSuccess(tx, results) {
%  var len = results.rows.length;
%    $('#groups_day_ul').empty();
%    var html;
%    var id=0;
%    var description="";
%    var start = "";
%    var t_id_session=-1;
%    for (var i=0;i<len;i++) {
%      id = results.rows.item(i).id;
%      t_id_session = results.rows.item(i).t_id_session;
%      start = results.rows.item(i).s_h_start;  
%      description = results.rows.item(i).description; 
%      html = "<li>";
%      html += "<div data-role='fieldcontain'>";
%      html += start;
%   html += "<a data-role='button' data-iconpos='notext' style='float: right;' href='index.html#list_students_attendance' ";
%    html += " onClick=\"listStudentsAttendance(" + results.rows.item(i).t_id_group + ","+t_id_session + ");\">" + description + "</a>";
%     html += "";
%     html += "</div>";
%     html += "</li>";
%    $('#groups_day_ul').append(html);
%    }
%    $('#groups_day_ul').listview('refresh');
%    }
% 
% /* Query groups per day - Main Window -
% */
% function querySchedulePerDayDB(tx){
%  var query = "SELECT teacher_schedule.id_session, teacher_schedule.day, teacher_schedule.id_group as t_id_group, teacher_schedule.id_session as t_id_session, ";
%   query += " groups.id as g_id, groups.data as description, sessions.id as s_id, sessions.h_start as s_h_start, sessions.h_end as s_h_text FROM teacher_schedule, groups, sessions ";
%   query += " WHERE day=" +week_day_global + " AND g_id=t_id_group AND t_id_session=s_id  ORDER BY t_id_session;";
%   console.log("querySchedulePerDayDB:" + query);
%   tx.executeSql(query,[], dbSuccessFunc = function(tx,rs){
%     queryScheduleSuccess(tx, rs);},
%       dbErrorFunc = function(tx, e) {
%     if (tx.message) e = tx;
%     alert(" There has been an error QuerySchedulePerDayDB: " + e.message);
%     return false;
%       });   
% }
% 
%  j) Add attendance, misbehaviour for each student. Student attendance, misbehaviour, punctuality are set here.
% Tasks to be done
%  k) Add error handling. Error handling is managed throw dbErrorFunc.
%  l) Retrieve and insert data from and to database. 
%  m) List of attendance, misbehaviour incidents. A list of attendance will be carried on, reusing Siestta interfaces.
%  n) Add activities grades for each student. 
%  o) List students marks and final mark. On a window, group, student name and surname will be shown, and a table with his/her marks.
%  p) Activities management window. Add, remove and update activities. It includes name of activity and percent weight.
%  q) Management of student notes. Student's notes could be included as an option.
%  r) List of student notes. In a table-like window, notes will be displayed.
% ).
% Make a group management window.
%  h) Students: These pages are not active.
% Make list of students window.
% Students management window (insert-update-delete students)
%  i) Timetable for actual date: list of groups for selected day.
% Below queryScheduleSuccess() and querySchedulePerDayDB() functions are written, these functions fills daily_schedule page as shown in Illustration 6: Application Skeleton.
% 
% /*
%  *  Main Window
%  */
% function queryScheduleSuccess(tx, results) {
%  var len = results.rows.length;
%    $('#groups_day_ul').empty();
%    var html;
%    var id=0;
%    var description="";
%    var start = "";
%    var t_id_session=-1;
%    for (var i=0;i<len;i++) {
%      id = results.rows.item(i).id;
%      t_id_session = results.rows.item(i).t_id_session;
%      start = results.rows.item(i).s_h_start;  
%      description = results.rows.item(i).description; 
%      html = "<li>";
%      html += "<div data-role='fieldcontain'>";
%      html += start;
%   html += "<a data-role='button' data-iconpos='notext' style='float: right;' href='index.html#list_students_attendance' ";
%    html += " onClick=\"listStudentsAttendance(" + results.rows.item(i).t_id_group + ","+t_id_session + ");\">" + description + "</a>";
%     html += "";
%     html += "</div>";
%     html += "</li>";
%    $('#groups_day_ul').append(html);
%    }
%    $('#groups_day_ul').listview('refresh');
%    }
% 
% /* Query groups per day - Main Window -
% */
% function querySchedulePerDayDB(tx){
%  var query = "SELECT teacher_schedule.id_session, teacher_schedule.day, teacher_schedule.id_group as t_id_group, teacher_schedule.id_session as t_id_session, ";
%   query += " groups.id as g_id, groups.data as description, sessions.id as s_id, sessions.h_start as s_h_start, sessions.h_end as s_h_text FROM teacher_schedule, groups, sessions ";
%   query += " WHERE day=" +week_day_global + " AND g_id=t_id_group AND t_id_session=s_id  ORDER BY t_id_session;";
%   console.log("querySchedulePerDayDB:" + query);
%   tx.executeSql(query,[], dbSuccessFunc = function(tx,rs){
%     queryScheduleSuccess(tx, rs);},
%       dbErrorFunc = function(tx, e) {
%     if (tx.message) e = tx;
%     alert(" There has been an error QuerySchedulePerDayDB: " + e.message);
%     return false;
%       });   
% }
% 
%  j) Add attendance, misbehaviour for each student. Student attendance, misbehaviour, punctuality are set here.
% Tasks to be done
%  k) Add error handling. Error handling is managed throw dbErrorFunc.
%  l) Retrieve and insert data from and to database. 
%  m) List of attendance, misbehaviour incidents. A list of attendance will be carried on, reusing Siestta interfaces.
%  n) Add activities grades for each student. 
%  o) List students marks and final mark. On a window, group, student name and surname will be shown, and a table with his/her marks.
%  p) Activities management window. Add, remove and update activities. It includes name of activity and percent weight.
%  q) Management of student notes. Student's notes could be included as an option.
%  r) List of student notes. In a table-like window, notes will be displayed
% 
% 
% 
% \end{verbatim}
% 


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\section{Database structure \label{DataBase}}
\begin{bclogo}[couleur=green!30,arrondi=0.1, logo=\bcpanchant,  ombre=true ] 
{EduXes Database structure}   
\begin{verbatim}
-- Groups
CREATE TABLE IF NOT EXISTS GROUPS (id  integer primary key ,
    data text , other_data text);
--- Students
CREATE TABLE IF NOT EXISTS STUDENTS (
      id integer primary key, id_group integer not null,
       name text, surname text,
      repeated integer, n_date text , photo text,
      tutor TEXT, address TEXT, phone text, e_phone text,
       nation text,
      FOREIGN KEY(id_group) REFERENCES GROUPS(id));
-- Sessions ( franja horaria)
CREATE TABLE IF NOT EXISTS SESSIONS (id  integer primary key,
        description text, h_start text, h_end text);
-- Teacher's schedule
CREATE TABLE IF NOT EXISTS TEACHER_SCHEDULE (id  integer primary key,
      id_session integer, day integer, id_group integer,
      FOREIGN KEY(id_group) REFERENCES GROUPS(id),
      FOREIGN KEY(id_session) REFERENCES SESSIONS(id));
-- Students Attendance
CREATE TABLE IF NOT EXISTS ATTENDANCE (id integer primary key ,
      id_group integer, id_student integer, id_session integer,
      a_type integer, a_date text,
      FOREIGN KEY (id_student) REFERENCES STUDENTS (id),
      FOREIGN KEY (id_group) REFERENCES GROUPS(id),
      FOREIGN KEY (id_session) REFERENCES SESSIONS(id) );
-- Activities
CREATE TABLE IF NOT EXISTS ACTIVITIES
    (id integer primary key, name text, date_init text, 
    date_end text, weight integer, final integer );
CREATE TABLE IF NOT EXISTS activities_student
    (id integer primary key ,  id_student integer,
     id_activity integer,
    mark integer, a_date text, notes text,
    FOREIGN KEY (id_student) REFERENCES students (id),
    FOREIGN KEY (id_activity) REFERENCES activities(id) );
CREATE TABLE IF NOT EXISTS activities_group
    (id integer primary key ,  id_group integer,
     id_activity integer,
    enabled integer, a_date text, notes text,
    FOREIGN KEY (id_group) REFERENCES groups (id),
    FOREIGN KEY (id_activity) REFERENCES activities(id) );

\end{verbatim}
\end{bclogo}

\section{Los algoritmos para el desarrollo de la solución}
\dots

\section {qué quieres resolver}
\dots
\section {cómo lo vas a hacer}
\dots
\section {herramientas conceptuales necesarias}
 \dots

%% NOISE
NOISE vvvv


\begin{framed}
  ASD
\end{framed}
